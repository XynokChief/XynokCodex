/*--- This file is automatically generated by Xynok Codex, dont modify it manually. ---*/
using System;
using XynokEntity.AnimPhasing;
using XynokEntity.AnimPhasing.Data;
using XynokSourceGenerator.Entities.APIs;
using Sirenix.OdinInspector;
using XynokConvention;

namespace XynokSourceGenerator.Entities.StateMachine
{
    [Serializable]
    public class CharacterAnimClipData : EntityAnimClipData<ICharacter>
    {
    }

    [Serializable]
    public class CharacterEntityFrameRangeData : EntityFrameRangeData<ICharacter>
    {
    }

    public class CharacterAnimatorFrameDataContainer : EntityAnimatorFrameDataContainer<ICharacter>
    {
        [FoldoutGroup(ConventionKey.Settings)]
        [Button(ButtonSizes.Medium), GUIColor(Colors.Purple)]
        void InitAnimatorStateMachine()
        {
#if UNITY_EDITOR
            var controller = animator.runtimeAnimatorController as UnityEditor.Animations.AnimatorController;
            var behaviors = controller.GetBehaviours<CharacterAnimatorStateMachine>();
            foreach (var behavior in behaviors)
            {
                DestroyImmediate(behavior, true);
            }

            var result = controller.layers[0].stateMachine.AddStateMachineBehaviour<CharacterAnimatorStateMachine>();
            result.stateNames = new string[clipsData.Length];

            for (int i = 0; i < clipsData.Length; i++)
            {
                var clipData = clipsData[i];
                result.stateNames[i] = clipData.clip.name;
            }

            result.frameDataContainer = this;
#endif
        }
    }
}